# hdevieux primary tmux config

###################
# System Settings #
###################

# Default Terminal to xterm
set -g default-terminal "screen-256color"

# This is needed for automatic plugin installation
set-environment -g TMUX_PLUGIN_MANAGER_PATH '~/.tmux/plugins'

#####################
# Base Key Bindings #
#####################

# Change prefix to ctrl-Space
unbind C-b
set -g prefix C-Space
bind-key Space send-prefix

# Easy reload tmux config
bind-key r source-file ~/.tmux.conf \; display-message "~/.tmux.conf reloaded"

# Unbind a bunch of defaults
unbind Up
unbind Left
unbind Right
unbind Down
unbind C-Up
unbind C-Left
unbind C-Right
unbind C-Down
unbind M-Up
unbind M-Left
unbind M-Right
unbind M-Down
unbind n
unbind %
unbind &
unbind .
unbind ,

###################
# System Settings #
###################

# Window index
set -g base-index 1

# VI Mode
setw -g mode-keys vi

# Mouse mode on
set -g mouse on

# Monitor Activity 
setw -g monitor-activity on
set -g visual-activity on

# Don't make messages disappear so quickly
set -g display-time 2000

# 12 Hour clock
setw -g clock-mode-style 12

############################
# Pane and Window Settings #
############################

# Closing and opening windows
bind-key x kill-pane
bind-key X kill-window
bind-key / split-window -h
bind-key . split-window -v
bind-key n new-window
bind-key -r Tab next-window

# Resizing panes
bind-key -r H resize-pane -L 5
bind-key -r J resize-pane -D 5
bind-key -r K resize-pane -U 5
bind-key -r L resize-pane -R 5

# Moving between panes
bind-key -r h select-pane -L
bind-key -r j select-pane -D
bind-key -r k select-pane -U
bind-key -r l select-pane -R

# Rename window based on running application
setw -g automatic-rename on

# Renumber windows as they get closed
set -g renumber-windows on

# Set terminal titles
set -g set-titles on
set -g set-titles-string '| #h | #S | #I:#W |'

#################################
# Status and Messaging Settings #
#################################

set -g status on
set -g status-style none
set -g status-justify centre

# Use UTF-8 - Disabled for now.
# setw -g status-utf8 on

# Update the status bar every 30 seconds
set -g status-interval 30

# Format for window descriptions
setw -g window-status-current-format "|#I: #W (#{window_panes} panes)|"
setw -g window-status-format "|#I: #W (#{window_panes} panes)|"
setw -g window-status-separator "  "

# Status Bar format
set -g status-right-length 80
set -g status-left-length 120
set -g status-left "#[fg=green]#h #[fg=colour245]:: #[fg=red][#S] Window #I/#{session_windows}"
set -g status-right "%m-%d-%y %H:%M #[fg=colour245]:: #[fg=brightblue]#(spotify_status_line)"

##################
# Color Settings #
##################

# Status bar
set -g status-bg colour234
set -g status-fg brightred
set -g status-attr dim

# Currently selected window
set -g window-status-current-fg colour032
set -g window-status-current-bg colour234
set -g window-status-current-attr bright

# None selected windows
setw -g window-status-fg colour245
setw -g window-status-bg colour234
setw -g window-status-attr dim

# Messages in status line
set -g message-bg colour220
set -g message-fg colour232
set -g message-attr bold

# Window selection menu
setw -g mode-bg colour234
setw -g mode-fg colour032

##################
#     Plugins    #
##################

set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-resurrect'

# Change resurrect save dir so these files arent checked into git
set -g @resurrect-dir '~/tmp/'

# Somewhat hack to install plugins
# I prefer to not check them into personal dotfiles
if "test ! -d ~/.tmux/plugins/tpm" \
    "run 'git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm'; \
    run '~/.tmux/plugins/tpm/bin/install_plugins'"

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run '~/.tmux/plugins/tpm/tpm'
